#!/usr/bin/env sh
path="$1"
test "$path" = "" && { echo "Usage: $0 <path>" >&2; exit 1; }
test -d "$path" || { echo "$path does not exist" >&2; exit 1; }
cd $path
name="$(basename "$path")"
version="$(grep -Po "Version: \K.+" "$name.toc")"
git archive --format=zip -o "../$name-$version.zip" --prefix="$name/" HEAD .